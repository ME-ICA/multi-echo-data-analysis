
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BOLD, non-BOLD, and TE-dependence with tedana &#8212; Multi-Echo fMRI Data Analysis</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Open Multi-Echo Datasets" href="Multi_Echo_Datasets.html" />
    <link rel="prev" title="Signal Decay" href="Signal_Decay.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Multi-Echo fMRI Data Analysis</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Multi-Echo (fMRI) Data Analysis
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Course Overview
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Course_Overview.html">
   Course Overview
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Download_Data.html">
   Download Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Install_Software.html">
   Install Software
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Recommended_Reading.html">
   Recommended Reading
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Theoretical Background
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="MR_Physics.html">
   MR Physics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fMRI_Sequences.html">
   Multi-Echo fMRI Sequences
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Signal_Decay.html">
   Signal Decay
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   BOLD, non-BOLD, and TE-dependence with tedana
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Practical Resources
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Multi_Echo_Datasets.html">
   Open Multi-Echo Datasets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Acquiring_Multi_Echo_Data.html">
   Acquiring Multi-Echo Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Processing_Multi_Echo_Data.html">
   Processing Multi-Echo Data
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Analysis Tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="01_Optimal_Combination_with_t2smap.html">
   Optimal combination in t2smap
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_Volume-wise_T2star_estimation_with_t2smap.html">
   Volume-wise T2*/S0 estimation with t2smap
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_Denoising_with_tedana.html">
   Multi-Echo Denoising with tedana
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04_Dual_Echo_Denoising.html">
   Dual-Echo Denoising with nilearn
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05_3dMEPFM.html">
   3dMEPFM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06_Cerebrovascular_Mapping.html">
   Cerebrovascular Mapping
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="07_Manual_Classification_with_rica.html">
   Manual Classification with rica
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Background Information
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="markdown.html">
   Markdown Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks.html">
   Content with notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bibliography.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/content/TE_Dependence.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-figures-and-examples-for-dependence-metric-calculation">
   Make figures and examples for dependence metric calculation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-simulations-of-bold-and-non-bold-signals-as-a-function-of-echo-time">
     Plot simulations of BOLD and non-BOLD signals as a function of echo time
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#make-design-matrices">
     Make design matrices
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#te-independence-model">
     TE-independence model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#te-dependence-model">
     TE-dependence model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fitted-curves-for-s0-perturbed-signal">
     Fitted curves for S0-perturbed signal
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fitted-curves-for-r2-perturbed-signal">
     Fitted curves for R2*-perturbed signal
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#now-let-s-apply-this-approach-to-components">
     Now let’s apply this approach to components
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="bold-non-bold-and-te-dependence-with-tedana">
<h1>BOLD, non-BOLD, and TE-dependence with tedana<a class="headerlink" href="#bold-non-bold-and-te-dependence-with-tedana" title="Permalink to this headline">¶</a></h1>
<div class="section" id="make-figures-and-examples-for-dependence-metric-calculation">
<h2>Make figures and examples for dependence metric calculation<a class="headerlink" href="#make-figures-and-examples-for-dependence-metric-calculation" title="Permalink to this headline">¶</a></h2>
<p>This notebook uses simulated T2*/S0 manipulations to show how TE-dependence is leveraged to denoise multi-echo data.</p>
<p>The equation for how signal is dependent on changes in S0 and T2*:
$<span class="math notranslate nohighlight">\(S(t, TE_k) = \bar{S}(TE_k) * (1 + \frac{{\Delta}{S_0}(t)}{\bar{S}_0} - {\Delta}{R_2^*}(t)*TE_k)\)</span>$</p>
<div class="section" id="plot-simulations-of-bold-and-non-bold-signals-as-a-function-of-echo-time">
<h3>Plot simulations of BOLD and non-BOLD signals as a function of echo time<a class="headerlink" href="#plot-simulations-of-bold-and-non-bold-signals-as-a-function-of-echo-time" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="make-design-matrices">
<h3>Make design matrices<a class="headerlink" href="#make-design-matrices" title="Permalink to this headline">¶</a></h3>
<p>For TEDPCA and TEDICA, we use regression to get parameter estimates (PEs; not beta values) for component time-series against echo-specific data, and substitute those PEs for <span class="math notranslate nohighlight">\({\bar{S}(TE_k)}\)</span>. At some point, I would like to dig into why those parameter estimates are equivalent to <span class="math notranslate nohighlight">\({\bar{S}(TE_k)}\)</span> for our purposes.</p>
</div>
<div class="section" id="te-independence-model">
<h3>TE-independence model<a class="headerlink" href="#te-independence-model" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\frac{{\Delta}S(TE_k)}{\bar{S(TE_k)}} = \frac{{\Delta}S_0}{S_0}\]</div>
<div class="math notranslate nohighlight">
\[{\Delta}S(TE_k) = {\bar{S}(TE_k)}\frac{{\Delta}S_0}{S_0}\]</div>
<p><span class="math notranslate nohighlight">\(\frac{{\Delta}S_0}{S_0}\)</span> is a scalar (i.e., doesn’t change with TE), so we ignore that, which means we only use <span class="math notranslate nohighlight">\({\bar{S}(TE_k)}\)</span> (mean echo-wise signal).</p>
<p>Thus,</p>
<div class="math notranslate nohighlight">
\[{\Delta}S(TE_k) = {\bar{S}(TE_k)} * X\]</div>
<p>and for TEDPCA/TEDICA,</p>
<div class="math notranslate nohighlight">
\[PE(TE_k) = {\bar{S}(TE_k)} * X\]</div>
<p>Lastly, we fit X to the data and evaluate model fit.</p>
</div>
<div class="section" id="te-dependence-model">
<h3>TE-dependence model<a class="headerlink" href="#te-dependence-model" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\frac{{\Delta}S(TE_k)}{\bar{S}(TE_k)} = -{\Delta}{R_2^*}*TE_k\]</div>
<div class="math notranslate nohighlight">
\[{\Delta}S(TE_k) = {\bar{S}(TE_k)} * -{\Delta}{R_2^*}*TE_k\]</div>
<p><span class="math notranslate nohighlight">\(-{\Delta}{R_2^*}\)</span> is a scalar, so we ignore it, which means we only use <span class="math notranslate nohighlight">\({\bar{S}(TE_k)}\)</span> (mean echo-wise-signal) and <span class="math notranslate nohighlight">\(TE_k\)</span> (echo time in milliseconds).</p>
<p>Thus,</p>
<div class="math notranslate nohighlight">
\[{\Delta}S(TE_k) = {\bar{S}(TE_k)}*TE_k * X\]</div>
<p>and for TEDPCA/TEDICA,</p>
<div class="math notranslate nohighlight">
\[PE(TE_k) = {\bar{S}(TE_k)}*TE_k * X\]</div>
<p>Lastly, we fit X to the data and evaluate model fit.</p>
</div>
<div class="section" id="fitted-curves-for-s0-perturbed-signal">
<h3>Fitted curves for S0-perturbed signal<a class="headerlink" href="#fitted-curves-for-s0-perturbed-signal" title="Permalink to this headline">¶</a></h3>
<p>The predicted curve for the S0 model matches the real curve perfectly!</p>
</div>
<div class="section" id="fitted-curves-for-r2-perturbed-signal">
<h3>Fitted curves for R2*-perturbed signal<a class="headerlink" href="#fitted-curves-for-r2-perturbed-signal" title="Permalink to this headline">¶</a></h3>
<p>For some reason, the predicted curve for the R2 model doesn’t match the real signal curve.
What’s with this mismatch?</p>
<p>It seems like the mismatch increases as the difference between the fluctuating volume’s R2 and the mean R2 increase.
The fitted curve seems to actually match the mean signal, not the perturbed signal!</p>
</div>
<div class="section" id="now-let-s-apply-this-approach-to-components">
<h3>Now let’s apply this approach to components<a class="headerlink" href="#now-let-s-apply-this-approach-to-components" title="Permalink to this headline">¶</a></h3>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="Signal_Decay.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Signal Decay</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="Multi_Echo_Datasets.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Open Multi-Echo Datasets</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By The tedana community<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>